[run]
phase = "sft"
name = "sft_stage1b_magnitude_shift"
seed = 1337
output_dir = "outputs/checkpoints/sft_stage1b_magnitude_shift"

[data]
train_jsonl = "data/processed/stage1b/train_sft.jsonl"
val_jsonl = "data/processed/stage1b/val.jsonl"
test_jsonl = "data/processed/stage1b/test.jsonl"
tokenization_mode = "hex_pair"
track = "template_delta_operand_patch"
target_mode = "patch_text"
decode_min_int = -1000
decode_max_int = 1000

[model]
layers = 6
hidden_size = 512
heads = 8
seq_len = 2048
dropout = 0.0

[optimizer]
scheme = "adamw"
lr_adamw = 3e-4
weight_decay = 0.01
betas = [0.9, 0.95]
eps = 1e-8

[init]
mode = "scratch"
warmstart_ckpt = ""
textmix_ratio = 0.0

[rl]
beta = 0.01
rollout_samples = 32
mode = "mainline"
init_ckpt = "outputs/checkpoints/sft_stage1b_magnitude_shift/checkpoint.json"

[train]
batch_size = 32
epochs = 20
max_steps = 3000
log_interval = 20
eval_interval = 100
full_eval_every = 3
save_interval = 300
eval_max_samples = 256
max_gen_tokens = 32
grad_clip_norm = 1.0
warmup_steps = 200
min_lr_ratio = 0.1
label_smoothing = 0.0
